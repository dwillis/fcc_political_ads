{% extends "fcc-base.html" %}{% load static from staticfiles %}
{% block bodyclass %}broadcasters{% endblock bodyclass %}
{% block content %}
    <h1>{{ state_name }} ({{ broadcaster_list|length }} stations)</h1>
    <div>
        <p>Find stations near you! Use this form to search for TV stations within a search radius. This will return a list of stations ordered by distance (as the crow flies). Actual driving distance will vary.</p>
        <form id="map_form" class="form-inline" action="map_submit" method="get" accept-charset="utf-8">
            <label>
                Address: 
                <input type="textbox" name="address" id="address" class="span4" value="" size="75" autofocus>
            </label>
            <label>
                Radius: 
                <select  name="radius" id="radius" class="span1">
                    <option value="10">10</option>
                    <option value="25" selected>25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                    <option value="200">200</option>
                </select>
                <span class="add-on">miles</span>
            </label>
            <input class="btn" type="submit" value="Search">
        </form>
    </div>
    <div id="map-box">
        <div id="map_canvas" style="width:100%; height:100%"></div>
    </div>
{% endblock content %}

{% block sidebar %}
<div id="stations">
    <ul id="locations"></ul>
</div>
{% endblock sidebar %}

{% block head %}
    {{ block.super }}
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBJAvCwnDreQHJ_cAlbXAm9Fb_LmjvlaTI&sensor=false&libraries=geometry"></script>
{% endblock head %}

{% block js %}
    {{ block.super }}
    <script src="{% static 'js/map_stations.js' %}" type="text/javascript" charset="utf-8"></script>
    <script>
        var startPos = {{ broadcaster_list.0.addresses.1.pos|default:"[0,0]" }};
        var locations = [
            {% for broadcaster in broadcaster_list %}{{ broadcaster.as_json|safe }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];
        var userMarker_url = "{% static 'img/sll_map_marker_purple.png' %}";
        var stationMarker_url = "{% static 'img/sll_map_marker_blue.png' %}";
        $(document).ready(function() {
            if (!("autofocus" in document.createElement("input"))) {
                  $("#address").focus();
            }
            if(!Modernizr.inputtypes.number) {
                
            }
        });
        
    </script>
    <script src="{% static "js/fcc_site.js" %}" type="text/javascript" charset="utf-8"></script>
{% endblock js %}